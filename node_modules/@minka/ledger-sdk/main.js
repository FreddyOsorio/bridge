(()=>{"use strict";var __webpack_modules__={8286:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(__webpack_require__(7636),exports),__exportStar(__webpack_require__(6090),exports),__exportStar(__webpack_require__(9517),exports),__exportStar(__webpack_require__(6503),exports)},6819:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.importEncryptedPrivateKey=exports.exportEncryptedPrivateKey=void 0;const asn1_1=__webpack_require__(8596);exports.exportEncryptedPrivateKey=function(key){const iterationsBuffer=Buffer.alloc(2);return iterationsBuffer.writeUInt16BE(key.iterations),Buffer.concat([Buffer.from(asn1_1.ASN1_PKCS5_SALT_PREFIX,"hex"),key.salt,Buffer.from(asn1_1.ASN1_PKCS5_ITERATIONS_PREFIX,"hex"),iterationsBuffer,Buffer.from(asn1_1.ASN1_PKCS5_IV_PREFIX,"hex"),key.iv,Buffer.from(asn1_1.ASN1_PKCS5_VALUE_PREFIX,"hex"),key.value]).toString("base64")},exports.importEncryptedPrivateKey=function(key){const payloadAsn1Hex=Buffer.from(key,"base64").toString("hex"),{salt,iterations,iv,value}=(0,asn1_1.parsePkcs5EncryptedKey)(payloadAsn1Hex);return{salt:Buffer.from(salt,"hex"),iterations:Buffer.from(iterations,"hex").readUInt16BE(),iv:Buffer.from(iv,"hex"),value:Buffer.from(value,"hex")}}},7443:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.verifyJWT=exports.signJWT=exports.parseB64Object=exports.bufferConcat=void 0;const jose_1=__webpack_require__(1567),ed25519=__importStar(__webpack_require__(599)),util_1=__webpack_require__(3837);function bufferConcat(...buffers){const size=buffers.reduce(((acc,{length})=>acc+length),0),buf=new Uint8Array(size);let i=0;return buffers.forEach((buffer=>{buf.set(buffer,i),i+=buffer.length})),buf}function parseB64Object(b64){const decoder=new util_1.TextDecoder,decoded=jose_1.base64url.decode(b64);return JSON.parse(decoder.decode(decoded))}exports.bufferConcat=bufferConcat,exports.parseB64Object=parseB64Object,exports.signJWT=async function(payload,secret){const encoder=new util_1.TextEncoder;let payloadBuffer=encoder.encode(JSON.stringify(payload));payloadBuffer=encoder.encode(jose_1.base64url.encode(payloadBuffer));const header={alg:"EdDSA"},data=bufferConcat(encoder.encode(jose_1.base64url.encode(JSON.stringify(header))),encoder.encode("."),payloadBuffer),dataHash=Buffer.from(data).toString("hex"),privateKey=Buffer.from(secret,"base64");try{const signature=await ed25519.sign(dataHash,privateKey),encodedSignature=jose_1.base64url.encode(signature);return`${jose_1.base64url.encode(JSON.stringify(header))}.${jose_1.base64url.encode(JSON.stringify(payload))}.${encodedSignature}`}catch(error){if("Expected 32 bytes"===error.message){const publicLength=Buffer.from(secret,"base64").toString("hex").length;throw new Error(`Unexpected raw private key length in hex ${publicLength}, expected 64`)}throw new Error("jwt signing failed")}},exports.verifyJWT=async function(jws,publicKey){const encoder=new util_1.TextEncoder,{0:protectedHeader,1:payload,2:signature}=jws.split(".");if(!protectedHeader||!payload||!signature)throw new Error("Invalid Compact JWS");const data=bufferConcat(encoder.encode(protectedHeader),encoder.encode("."),encoder.encode(payload)),dataHash=Buffer.from(data).toString("hex");let verified=!1;try{verified=await ed25519.verify(Buffer.from(signature,"base64"),dataHash,Buffer.from(publicKey,"base64"))}catch(error){if("Expected 32 bytes"===error.message){const publicLength=Buffer.from(publicKey,"base64").toString("hex").length;throw new Error(`Unexpected raw public key length in hex ${publicLength}, expected 64`)}verified=!1}if(!verified)throw new Error("signature verification failed");const decodedPayload=parseB64Object(payload);if(decodedPayload.iat>=decodedPayload.exp||decodedPayload.exp<Date.now()/1e3)throw new Error('"exp" claim timestamp check failed');return{payload:parseB64Object(payload),protectedHeader:parseB64Object(protectedHeader)}}},3144:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.decryptSecretKey=exports.encryptSecretKey=exports.createKeyPair=void 0;const ed25519=__importStar(__webpack_require__(599)),crypto_1=__importDefault(__webpack_require__(6113)),asn1_1=__webpack_require__(8596),format_1=__webpack_require__(6819),webcrypto=global?.crypto??crypto_1.default?.webcrypto;function assertWebcryptoSupport(){if(!webcrypto)throw new Error("Unable to perform operation, `webcrypto` is not defined");if(!webcrypto.subtle)throw new Error("Unable to perform operation, `webcrypto.subtle` is not defined")}exports.createKeyPair=async function(){const privateKey=ed25519.utils.randomPrivateKey(),publicKey=await ed25519.getPublicKey(privateKey);return{schema:"ed25519",public:Buffer.from(publicKey).toString("base64"),secret:Buffer.from(privateKey).toString("base64")}},exports.encryptSecretKey=async function(secret,password){assertWebcryptoSupport();const salt=webcrypto.getRandomValues(new Uint8Array(8)),iv=webcrypto.getRandomValues(new Uint8Array(16)),keyMaterial=await webcrypto.subtle.importKey("raw",Buffer.from(password,"utf-8"),"PBKDF2",!1,["deriveKey"]),key=await webcrypto.subtle.deriveKey({name:"PBKDF2",salt,iterations:2048,hash:"SHA-256"},keyMaterial,{name:"AES-CBC",length:256},!1,["encrypt"]),secretHex=Buffer.from(secret,"base64").toString("hex"),encrypted=await webcrypto.subtle.encrypt({name:"AES-CBC",iv},key,Buffer.from((0,asn1_1.privateKeyRawToDer)(secretHex),"hex")),encryptedKey={salt,iterations:2048,iv,value:Buffer.from(encrypted)};return(0,format_1.exportEncryptedPrivateKey)(encryptedKey)},exports.decryptSecretKey=async function(secret,password){assertWebcryptoSupport();const{salt,iterations,iv,value}=(0,format_1.importEncryptedPrivateKey)(secret),keyMaterial=await webcrypto.subtle.importKey("raw",Buffer.from(password,"utf-8"),"PBKDF2",!1,["deriveKey"]),key=await webcrypto.subtle.deriveKey({name:"PBKDF2",salt,iterations,hash:"SHA-256"},keyMaterial,{name:"AES-CBC",length:256},!1,["decrypt"]);let decrypted;try{decrypted=await webcrypto.subtle.decrypt({name:"AES-CBC",iv},key,value)}catch(error){throw new Error("Unable to decrypt secret key")}const rawKeyHex=(0,asn1_1.privateKeyDerToRaw)(Buffer.from(decrypted).toString("hex"));return Buffer.from(rawKeyHex,"hex").toString("base64")}},1477:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.verifySignature=exports.signHash=void 0;const ed25519=__importStar(__webpack_require__(599)),asserts_1=__webpack_require__(7115);exports.signHash=async function(hash,keyPair){(0,asserts_1.assertSigningSchema)(keyPair.schema);const privateKey=Buffer.from(keyPair.secret,"base64"),signature=await ed25519.sign(hash,privateKey);return{schema:keyPair.schema,public:keyPair.public,digest:hash,result:Buffer.from(signature).toString("base64")}},exports.verifySignature=async function(hash,signature){return(0,asserts_1.assertSigningSchema)(signature.schema),ed25519.verify(Buffer.from(signature.result,"base64"),hash,Buffer.from(signature.public,"base64"))}},8596:(__unused_webpack_module,exports)=>{function isValidPkcs5EncryptedKey(pkcs5PayloadHex){return exports.ASN1_PKCS5_REGEX.test(pkcs5PayloadHex)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.publicKeyRawToDer=exports.publicKeyDerToRaw=exports.privateKeyRawToDer=exports.privateKeyDerToRaw=exports.isValidPkcs5EncryptedKey=exports.assertPkcs5EncryptedKey=exports.parsePkcs5EncryptedKey=exports.ASN1_PKCS5_REGEX=exports.ASN1_PKCS5_VALUE_PREFIX=exports.ASN1_PKCS5_IV_PREFIX=exports.ASN1_PKCS5_ITERATIONS_PREFIX=exports.ASN1_PKCS5_SALT_PREFIX=exports.ASN1_PUBLIC_PREFIX=exports.ASN1_PRIVATE_PREFIX=void 0,exports.ASN1_PRIVATE_PREFIX="302e020100300506032b657004220420",exports.ASN1_PUBLIC_PREFIX="302a300506032b6570032100",exports.ASN1_PKCS5_SALT_PREFIX="30819b305706092a864886f70d01050d304a302906092a864886f70d01050c301c0408",exports.ASN1_PKCS5_ITERATIONS_PREFIX="0202",exports.ASN1_PKCS5_IV_PREFIX="300c06082a864886f70d02090500301d060960864801650304012a0410",exports.ASN1_PKCS5_VALUE_PREFIX="0440",exports.ASN1_PKCS5_REGEX=new RegExp(`^${exports.ASN1_PKCS5_SALT_PREFIX}(?<salt>[0-9a-f]{16})${exports.ASN1_PKCS5_ITERATIONS_PREFIX}((?<iterations>[0-9a-f]{4}))${exports.ASN1_PKCS5_IV_PREFIX}(?<iv>[0-9a-f]{32})${exports.ASN1_PKCS5_VALUE_PREFIX}(?<value>[0-9a-f]{128})$`),exports.parsePkcs5EncryptedKey=function(pkcs5PayloadHex){const match=exports.ASN1_PKCS5_REGEX.exec(pkcs5PayloadHex);if(!match)throw new Error("Invalid pkcs5 encrypted key format");return match.groups},exports.assertPkcs5EncryptedKey=function(pkcs5PayloadHex){if(!isValidPkcs5EncryptedKey(pkcs5PayloadHex))throw new Error("Invalid pkcs5 encrypted key format")},exports.isValidPkcs5EncryptedKey=isValidPkcs5EncryptedKey,exports.privateKeyDerToRaw=function(keyHex){if(96!=keyHex.length)throw new Error(`Unexpected der private key length in hex ${keyHex.length}, expected 96`);if(!keyHex.startsWith(exports.ASN1_PRIVATE_PREFIX))throw new Error("Unexpected private key prefix");return keyHex.slice(exports.ASN1_PRIVATE_PREFIX.length)},exports.privateKeyRawToDer=function(keyHex){if(64!=keyHex.length)throw new Error(`Unexpected raw private key length in hex ${keyHex.length}, expected 64`);return`${exports.ASN1_PRIVATE_PREFIX}${keyHex}`},exports.publicKeyDerToRaw=function(keyHex){if(88!=keyHex.length)throw new Error(`Unexpected der public key length in hex ${keyHex.length}, expected 88`);if(!keyHex.startsWith(exports.ASN1_PUBLIC_PREFIX))throw new Error("Unexpected public key prefix");return keyHex.slice(exports.ASN1_PUBLIC_PREFIX.length)},exports.publicKeyRawToDer=function(keyHex){if(64!=keyHex.length)throw new Error(`Unexpected raw public key length in hex ${keyHex.length}, expected 64`);return`${exports.ASN1_PUBLIC_PREFIX}${keyHex}`}},7115:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.assertSigningSchema=void 0,exports.assertSigningSchema=function(schema){if("ed25519"!==schema)throw new Error(`Unsupported schema, expected 'ed25519', but got: '${schema}'`)}},7636:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createCompositeHash=exports.createHash=void 0;const crypto_1=__importDefault(__webpack_require__(6113)),serialization_1=__webpack_require__(881);function createHash(data){const serializedData=(0,serialization_1.serializeData)(data),dataHash=crypto_1.default.createHash("sha256").update(serializedData).digest("hex");return crypto_1.default.createHash("sha256").update(dataHash+serializedData).digest("hex")}exports.createHash=createHash,exports.createCompositeHash=function(dataHash,signatureCustom){if(!signatureCustom)return dataHash;const signatureHash=createHash(signatureCustom);return createHash(`${dataHash}.${signatureHash}`)}},6503:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.verifyJWT=exports.signJWT=exports.decodeJWT=void 0;const detect_node_1=__importDefault(__webpack_require__(7805)),lodash_1=__importDefault(__webpack_require__(6517)),jose_1=__webpack_require__(1567),jwt_1=__webpack_require__(6096),jwt_2=__webpack_require__(7443),format_1=__webpack_require__(8861);exports.decodeJWT=function(jwt){return function(payload){const{iss,sub,aud,jti,exp,iat,hsh}=payload,errors=[];if(iss&&lodash_1.default.isString(iss)||errors.push('"iss" must be a string'),aud&&lodash_1.default.isString(aud)||errors.push('"aud" must be a string'),jti&&!lodash_1.default.isString(jti)&&errors.push('"jti" must be a string'),hsh&&!lodash_1.default.isString(hsh)&&errors.push('"hsh" must be a string'),(!lodash_1.default.isNumber(iat)||iat<=0)&&errors.push('"iat" must be a positive number'),(!lodash_1.default.isNumber(exp)||exp<=0)&&errors.push('"exp" must be a positive number'),exp<iat&&errors.push('"exp" must be greater than "iat"'),errors.length)throw Error(`JWT Payload validation ${(0,format_1.pluralize)(errors.length,"error")}: ${errors.join(",")}.`);return{iss,sub,aud,jti,exp,iat,hsh}}((0,jose_1.decodeJwt)(jwt))},exports.signJWT=async function(payload,secret){return detect_node_1.default?(0,jwt_1.signJWT)(payload,secret):(0,jwt_2.signJWT)(payload,secret)},exports.verifyJWT=function(jwt,publicKey){return detect_node_1.default?(0,jwt_1.verifyJWT)(jwt,publicKey):(0,jwt_2.verifyJWT)(jwt,publicKey)}},6090:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.SUPPORTED_KEY_SCHEMAS=exports.isSecretKeyEncrypted=exports.decryptSecretKey=exports.encryptSecretKey=exports.createKeyPair=void 0;const detect_node_1=__importDefault(__webpack_require__(7805)),keys_1=__webpack_require__(3144),asn1_1=__webpack_require__(8596),keys_2=__webpack_require__(4419);exports.createKeyPair=async function(){return detect_node_1.default?(0,keys_2.createKeyPair)():(0,keys_1.createKeyPair)()},exports.encryptSecretKey=async function(secret,password){return detect_node_1.default?(0,keys_2.encryptSecretKey)(secret,password):(0,keys_1.encryptSecretKey)(secret,password)},exports.decryptSecretKey=async function(secret,password){return detect_node_1.default?(0,keys_2.decryptSecretKey)(secret,password):(0,keys_1.decryptSecretKey)(secret,password)},exports.isSecretKeyEncrypted=function(secret){return(0,asn1_1.isValidPkcs5EncryptedKey)(Buffer.from(secret,"base64").toString("hex"))},exports.SUPPORTED_KEY_SCHEMAS=["ed25519"]},3099:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.importPrivateKey=exports.importPublicKey=exports.exportPrivateKey=exports.exportPublicKey=void 0;const crypto_1=__webpack_require__(6113),asn1_1=__webpack_require__(8596);exports.exportPublicKey=function(key){if("public"!==key.type)throw new Error(`Unexpected key type '${key.type}', expected 'public'`);const keyAsn1Hex=key.export({format:"der",type:"spki"}).toString("hex");return Buffer.from((0,asn1_1.publicKeyDerToRaw)(keyAsn1Hex),"hex").toString("base64")},exports.exportPrivateKey=function(key){if("private"!==key.type)throw new Error(`Unexpected key type '${key.type}', expected 'private'`);const keyAsn1Hex=key.export({format:"der",type:"pkcs8"}).toString("hex");return Buffer.from((0,asn1_1.privateKeyDerToRaw)(keyAsn1Hex),"hex").toString("base64")},exports.importPublicKey=function(key){const keyHex=Buffer.from(key,"base64").toString("hex");return(0,crypto_1.createPublicKey)({format:"der",type:"spki",key:Buffer.from((0,asn1_1.publicKeyRawToDer)(keyHex),"hex")})},exports.importPrivateKey=function(key){const keyHex=Buffer.from(key,"base64").toString("hex");return(0,crypto_1.createPrivateKey)({format:"der",type:"pkcs8",key:Buffer.from((0,asn1_1.privateKeyRawToDer)(keyHex),"hex")})}},6096:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.verifyJWT=exports.signJWT=void 0;const jose_1=__webpack_require__(1567),format_1=__webpack_require__(3099);exports.signJWT=async function(payload,secret){return await new jose_1.SignJWT(payload).setProtectedHeader({alg:"EdDSA"}).sign((0,format_1.importPrivateKey)(secret))},exports.verifyJWT=async function(jwt,publicKey){return(0,jose_1.jwtVerify)(jwt,(0,format_1.importPublicKey)(publicKey),{algorithms:["EdDSA"]})}},4419:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.decryptSecretKey=exports.encryptSecretKey=exports.createKeyPair=void 0;const crypto_1=__webpack_require__(6113),util_1=__webpack_require__(3837),asn1_1=__webpack_require__(8596),format_1=__webpack_require__(3099),generateKeyPairAsync=crypto_1.generateKeyPair&&(0,util_1.promisify)(crypto_1.generateKeyPair);function assertCryptoSupport(){if(!generateKeyPairAsync)throw new Error("Unable to perform operation, `crypto.generateKeyPair` is not defined");if(!crypto_1.createPrivateKey)throw new Error("Unable to perform operation, `crypto.createPrivateKey` is not defined")}exports.createKeyPair=async function(){assertCryptoSupport();const keyPair=await generateKeyPairAsync("ed25519");return{schema:"ed25519",public:(0,format_1.exportPublicKey)(keyPair.publicKey),secret:(0,format_1.exportPrivateKey)(keyPair.privateKey)}},exports.encryptSecretKey=async function(secret,password){return assertCryptoSupport(),(0,format_1.importPrivateKey)(secret).export({format:"der",type:"pkcs8",passphrase:password,cipher:"aes-256-cbc"}).toString("base64")},exports.decryptSecretKey=async function(secret,password){assertCryptoSupport(),(0,asn1_1.assertPkcs5EncryptedKey)(Buffer.from(secret,"base64").toString("hex"));try{const key=(0,crypto_1.createPrivateKey)({key:Buffer.from(secret,"base64"),format:"der",type:"pkcs8",passphrase:password});return(0,format_1.exportPrivateKey)(key)}catch(error){if("ERR_OSSL_EVP_BAD_DECRYPT"===error?.code)throw new Error("Unable to decrypt secret key");throw error}}},2092:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.verifySignature=exports.signHash=void 0;const crypto_1=__importDefault(__webpack_require__(6113)),asserts_1=__webpack_require__(7115),format_1=__webpack_require__(3099);exports.signHash=async function(hash,keyPair){if((0,asserts_1.assertSigningSchema)(keyPair.schema),!crypto_1.default.sign)throw new Error("Unable to sign hash, `crypto.sign` is not defined");const hashBuffer=Buffer.from(hash,"hex"),key=(0,format_1.importPrivateKey)(keyPair.secret),result=crypto_1.default.sign(void 0,hashBuffer,key).toString("base64");return{schema:keyPair.schema,public:keyPair.public,digest:hash,result}},exports.verifySignature=async function(hash,signature){if((0,asserts_1.assertSigningSchema)(signature.schema),!crypto_1.default.verify)throw new Error("Unable to verify signature, `crypto.verify` is not defined");const hashBuffer=Buffer.from(hash,"hex"),signatureBuffer=Buffer.from(signature.result,"base64"),key=(0,format_1.importPublicKey)(signature.public);return crypto_1.default.verify(void 0,hashBuffer,key,signatureBuffer)}},881:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.serializeData=void 0;const safe_stable_stringify_1=__importDefault(__webpack_require__(8730));exports.serializeData=function(data){return(0,safe_stable_stringify_1.default)(data)}},9517:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.verifySignature=exports.signHash=void 0;const detect_node_1=__importDefault(__webpack_require__(7805)),signing_1=__webpack_require__(1477),hashing_1=__webpack_require__(7636),signing_2=__webpack_require__(2092);exports.signHash=async function(hash,keyPair,customData){const compositeHash=(0,hashing_1.createCompositeHash)(hash,customData);return detect_node_1.default?(0,signing_2.signHash)(compositeHash,keyPair):(0,signing_1.signHash)(compositeHash,keyPair)},exports.verifySignature=async function(hash,signature){const compositeHash=(0,hashing_1.createCompositeHash)(hash,signature.custom);return signature.digest===compositeHash&&(detect_node_1.default?(0,signing_2.verifySignature)(compositeHash,signature):(0,signing_1.verifySignature)(compositeHash,signature))}},8861:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(__webpack_require__(3194),exports),__exportStar(__webpack_require__(6917),exports)},3194:(__unused_webpack_module,exports)=>{function fromLedgerAmount(ledgerAmount,factor){if(ledgerAmount%1!=0)throw new Error("Input amount is not an integer");return ledgerAmount/factor}Object.defineProperty(exports,"__esModule",{value:!0}),exports.pluralize=exports.formatList=exports.toLedgerAmount=exports.fromLedgerAmount=exports.formatLedgerAmount=void 0,exports.formatLedgerAmount=function(ledgerAmount,factor){const nominalAmount=fromLedgerAmount(ledgerAmount,factor),numberOfDigits=Math.log10(factor);return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:numberOfDigits,minimumFractionDigits:numberOfDigits}).format(nominalAmount)},exports.fromLedgerAmount=fromLedgerAmount,exports.toLedgerAmount=function(nominalAmount,factor){const ledgerAmount=nominalAmount*factor;if(ledgerAmount%1!=0)throw new Error("Input nominal amount with given factor should produce integer ledger amount");return ledgerAmount};const listFormatter=new Intl.ListFormat("en-US",{style:"long",type:"conjunction"});exports.formatList=function(items){return listFormatter.format(items)},exports.pluralize=function(count,noun,suffix="s"){return 1===count?noun:`${noun}${suffix}`}},6917:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.assertContains=exports.assertValidUrl=exports.assertOptionsSelected=exports.assertValidWithFactor=exports.assertPowerOf10=exports.assertLessThanOrEqual=exports.assertGreaterThanOrEqual=exports.assertGreaterThan=exports.assertNumber=exports.assertValidIdentifier=exports.ADDRESS_REGEX=exports.HANDLE_REGEX=exports.assertNotEmptyString=void 0,exports.assertNotEmptyString=function(value){if("string"!=typeof value||""===value)throw new Error("Value cannot be empty.")},exports.HANDLE_REGEX=/^[a-z][a-z0-9_\-.]*$/,exports.ADDRESS_REGEX=/^(((?<schema>[a-zA-Z0-9_\-+.]+):)?(?<handle>[a-zA-Z0-9_\-+.]+))(@(?<parent>[a-zA-Z0-9_\-+.]+))?$/;const CAMEL_CASE_REGEX=/^[a-z][a-zA-Z0-9_\-.]*$/,ID_START_REGEX=/^[a-z]/;exports.assertValidIdentifier=function(value,format="handle"){if("address"!==format){if(!ID_START_REGEX.test(value))throw new Error("Value must start with a lowercase letter.");if("handle"!==format){if("camelCase"!==format);else if(!CAMEL_CASE_REGEX.test(value))throw new Error("Only values with letters, digits, _, -, and . are allowed.")}else if(!exports.HANDLE_REGEX.test(value))throw new Error("Only values with lowercase letters, digits, _, -, and . are allowed.")}else if(!exports.ADDRESS_REGEX.test(value))throw new Error("Value must follow the address format.")},exports.assertNumber=function(value){if(Number.isNaN(value))throw new Error("Please enter a valid number.")},exports.assertGreaterThan=function(value,minValue){if(value<=minValue)throw new Error(`Value must be greater than ${minValue}`)},exports.assertGreaterThanOrEqual=function(value,minValue){if(value<minValue)throw new Error(`Value must be greater than or equal ${minValue}`)},exports.assertLessThanOrEqual=function(value,maxValue){if(value>maxValue)throw new Error(`Value must be less than or equal ${maxValue}`)},exports.assertPowerOf10=function(value){if(Math.log10(value)%1!=0)throw new Error("Value must be a power of 10")},exports.assertValidWithFactor=function(value,factor){if(value*factor%1!=0)throw new Error("Smallest unit of amount can be "+1/factor)},exports.assertOptionsSelected=function(selection,requiredOptions=1){if(!selection||selection.length<requiredOptions)throw new Error(`Please select at least ${requiredOptions} option${requiredOptions>1?"s":""}`)},exports.assertValidUrl=function(url){try{new URL(url)}catch(e){throw new Error(`Value ${url} is not a valid URL.`)}},exports.assertContains=function(value,array){if(!array.includes(value))throw new Error(`Value must be one of ${array.join(", ")}`)}},1497:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseClient=void 0;const crypto_1=__webpack_require__(8286),lodash_1=__importDefault(__webpack_require__(6517)),ledger_sdk_error_1=__webpack_require__(5583);exports.BaseClient=class BaseClient{constructor(apiClient,secure={}){this.apiClient=apiClient,this.secure=secure}buildRequestHash(requestHashParams){let headers,protectedHeadersSuffix="";Array.isArray(requestHashParams.protectedHeaders)&&(headers=requestHashParams.protectedHeaders.reduce(((_headers,header)=>(protectedHeadersSuffix+=protectedHeadersSuffix?",":":",protectedHeadersSuffix+=header.name.toLowerCase(),Object.assign(_headers,{[header.name]:header.value}))),{}));return`${(0,crypto_1.createHash)({method:requestHashParams.method,url:requestHashParams.url,body:lodash_1.default.isEmpty(requestHashParams.body)?null:requestHashParams.body,headers:lodash_1.default.isEmpty(headers)?null:headers})}${protectedHeadersSuffix}`}async buildJwt(requestHashParams,authParams={}){if(lodash_1.default.isEmpty(!authParams)&&lodash_1.default.isEmpty(this.secure))return null;const params={...this.secure,...this.authParams,...authParams},iat=Math.floor((new Date).getTime()/1e3),jwtPayload={iat,exp:iat+params.exp,iss:params.iss,aud:params.aud,sub:params.sub||params.keyPair.public,jti:params.jti||void 0,hsh:this.buildRequestHash(requestHashParams)};return`Bearer ${await(0,crypto_1.signJWT)(jwtPayload,params.keyPair.secret)}`}async createRecord(path,ResponseClass,record,authParams){try{const token=await this.buildJwt({method:"POST",url:path,body:record,protectedHeaders:[]},authParams);return new ResponseClass(await this.apiClient.post(path,record,{headers:token?{Authorization:token}:{}}))}catch(error){throw new ledger_sdk_error_1.LedgerSdkError(error)}}async updateRecord(path,ResponseClass,record,authParams){try{const token=await this.buildJwt({method:"PUT",url:path,body:record,protectedHeaders:[]},authParams);return new ResponseClass(await this.apiClient.put(path,record,{headers:token?{Authorization:token}:{}}))}catch(error){throw new ledger_sdk_error_1.LedgerSdkError(error)}}async signRecord(path,ResponseClass,signature,authParams){try{const token=await this.buildJwt({method:"POST",url:path,body:signature,protectedHeaders:[]},authParams);return new ResponseClass(await this.apiClient.post(path,signature,{headers:token?{Authorization:token}:{}}))}catch(error){throw new ledger_sdk_error_1.LedgerSdkError(error)}}async getRecord(path,ResponseClass,authParams){try{const token=await this.buildJwt({method:"GET",url:path,body:{},protectedHeaders:[]},authParams);return new ResponseClass(await this.apiClient.get(path,{headers:token?{Authorization:token}:{}}))}catch(error){throw new ledger_sdk_error_1.LedgerSdkError(error)}}async getRecordsList(path,ResponseClass,params){try{const token=await this.buildJwt({method:"GET",url:path,body:{},protectedHeaders:[]},params?.authParams);return new ResponseClass(await this.apiClient.get(path,{params,paramsSerializer:{dots:!0},headers:token?{Authorization:token}:{}}))}catch(error){throw new ledger_sdk_error_1.LedgerSdkError(error)}}setAuthParams(authParams){this.authParams=authParams}}},1727:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.BridgeClient=exports.BridgesResponse=exports.BridgeResponse=void 0;const create_record_builder_1=__webpack_require__(1039),update_record_builder_1=__webpack_require__(477),list_response_1=__webpack_require__(329),record_response_1=__webpack_require__(9735),base_client_1=__webpack_require__(1497);class BridgeResponse extends record_response_1.BaseRecordResponse{constructor(response){super(response),this.bridge=response?.data?.data}}exports.BridgeResponse=BridgeResponse;class BridgesResponse extends list_response_1.BaseListResponse{constructor(response){super(response),this.bridges=response?.data?.data?.map((record=>record.data))}}exports.BridgesResponse=BridgesResponse;class BridgeClient extends base_client_1.BaseClient{init(record){const builder=new create_record_builder_1.CreateRecordBuilder((async(record,authParams)=>this.createRecord("/bridges",BridgeResponse,record,authParams)));return builder.init(record)}from(record){const builder=new update_record_builder_1.UpdateRecordBuilder((async(record,authParams)=>this.updateRecord(`/bridges/${encodeURIComponent(record.data.handle)}`,BridgeResponse,record,authParams)));return builder.init(record)}async read(handle,authParams){return this.getRecord(`/bridges/${encodeURIComponent(handle)}`,BridgeResponse,authParams)}async list(params){return this.getRecordsList("/bridges",BridgesResponse,params)}}exports.BridgeClient=BridgeClient},7341:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.EffectClient=exports.EffectsResponse=exports.EffectResponse=void 0;const create_record_builder_1=__webpack_require__(1039),update_record_builder_1=__webpack_require__(477),list_response_1=__webpack_require__(329),record_response_1=__webpack_require__(9735),base_client_1=__webpack_require__(1497);class EffectResponse extends record_response_1.BaseRecordResponse{constructor(response){super(response),this.effect=response?.data?.data}}exports.EffectResponse=EffectResponse;class EffectsResponse extends list_response_1.BaseListResponse{constructor(response){super(response),this.effects=response?.data?.data?.map((record=>record.data))}}exports.EffectsResponse=EffectsResponse;class EffectClient extends base_client_1.BaseClient{init(record){const builder=new create_record_builder_1.CreateRecordBuilder((async(record,authParams)=>this.createRecord("/effects",EffectResponse,record,authParams)));return builder.init(record)}from(record){const builder=new update_record_builder_1.UpdateRecordBuilder((async(record,authParams)=>this.updateRecord(`/effects/${encodeURIComponent(record.data.handle)}`,EffectResponse,record,authParams)));return builder.init(record)}async read(handle,authParams){return this.getRecord(`/effects/${encodeURIComponent(handle)}`,EffectResponse,authParams)}async list(params){return this.getRecordsList("/effects",EffectsResponse,params)}}exports.EffectClient=EffectClient},6383:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.InstanceClient=exports.InstancesResponse=exports.InstanceResponse=void 0;const create_record_builder_1=__webpack_require__(1039),update_record_builder_1=__webpack_require__(477),list_response_1=__webpack_require__(329),record_response_1=__webpack_require__(9735),base_client_1=__webpack_require__(1497);class InstanceResponse extends record_response_1.BaseRecordResponse{constructor(response){super(response),this.instance=response?.data?.data}}exports.InstanceResponse=InstanceResponse;class InstancesResponse extends list_response_1.BaseListResponse{constructor(response){super(response),this.instances=response?.data?.data?.map((record=>record.data))}}exports.InstancesResponse=InstancesResponse;class InstanceClient extends base_client_1.BaseClient{init(record){const builder=new create_record_builder_1.CreateRecordBuilder((async(record,authParams)=>this.createRecord("/ledgers",InstanceResponse,record,authParams)));return builder.init(record)}from(record){const builder=new update_record_builder_1.UpdateRecordBuilder((async(record,authParams)=>this.updateRecord(`/ledgers/${encodeURIComponent(record.data.handle)}`,InstanceResponse,record,authParams)));return builder.init(record)}async read(handle,authParams){return this.getRecord(`/ledgers/${encodeURIComponent(handle)}`,InstanceResponse,authParams)}async list(params){return this.getRecordsList("/ledgers",InstancesResponse,params)}}exports.InstanceClient=InstanceClient},7336:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.IntentClient=exports.IntentsResponse=exports.IntentResponse=void 0;const sign_intent_builder_1=__webpack_require__(4918),create_record_builder_1=__webpack_require__(1039),list_response_1=__webpack_require__(329),record_response_1=__webpack_require__(9735),base_client_1=__webpack_require__(1497);class IntentResponse extends record_response_1.BaseRecordResponse{constructor(response){super(response),this.intent=response?.data?.data}}exports.IntentResponse=IntentResponse;class IntentsResponse extends list_response_1.BaseListResponse{constructor(response){super(response),this.intents=response?.data?.data?.map((record=>record.data))}}exports.IntentsResponse=IntentsResponse;class IntentClient extends base_client_1.BaseClient{init(record){const builder=new create_record_builder_1.CreateRecordBuilder((async(record,authParams)=>this.createRecord("/intents",IntentResponse,record,authParams)));return builder.init(record)}from(record){return new sign_intent_builder_1.SignIntentBuilder((async(signature,authParams)=>this.signRecord(`/intents/${encodeURIComponent(record.data.handle)}/sign`,IntentResponse,signature,authParams)),record)}async read(handle,authParams){return this.getRecord(`/intents/${encodeURIComponent(handle)}`,IntentResponse,authParams)}async list(params){return this.getRecordsList("/intents",IntentsResponse,params)}}exports.IntentClient=IntentClient},9390:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.SignerClient=exports.SignersResponse=exports.SignerResponse=void 0;const signer_record_builder_1=__webpack_require__(6870),update_record_builder_1=__webpack_require__(477),list_response_1=__webpack_require__(329),record_response_1=__webpack_require__(9735),base_client_1=__webpack_require__(1497);class SignerResponse extends record_response_1.BaseRecordResponse{constructor(response){super(response),this.signer=response?.data?.data}}exports.SignerResponse=SignerResponse;class SignersResponse extends list_response_1.BaseListResponse{constructor(response){super(response),this.signers=response?.data?.data?.map((record=>record.data))}}exports.SignersResponse=SignersResponse;class SignerClient extends base_client_1.BaseClient{init(record){const builder=new signer_record_builder_1.SignerRecordBuilder((async(record,authParams)=>this.createRecord("/signers",SignerResponse,record,authParams)));return builder.init(record)}from(record){const builder=new update_record_builder_1.UpdateRecordBuilder((async(record,authParams)=>this.updateRecord(`/signers/${encodeURIComponent(record.data.handle)}`,SignerResponse,record,authParams)));return builder.init(record)}async read(handle,authParams){return this.getRecord(`/signers/${encodeURIComponent(handle)}`,SignerResponse,authParams)}async list(params){return this.getRecordsList("/signers",SignersResponse,params)}}exports.SignerClient=SignerClient},9659:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.StatusClient=exports.StatusResponse=void 0;const record_response_1=__webpack_require__(9735),base_client_1=__webpack_require__(1497);class StatusResponse extends record_response_1.BaseRecordResponse{constructor(response){super(response),this.status=response?.data?.data}}exports.StatusResponse=StatusResponse;class StatusClient extends base_client_1.BaseClient{async read(){return this.getRecord("",StatusResponse)}init(){return null}}exports.StatusClient=StatusClient},7285:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.SymbolClient=exports.SymbolsResponse=exports.SymbolResponse=void 0;const create_record_builder_1=__webpack_require__(1039),update_record_builder_1=__webpack_require__(477),list_response_1=__webpack_require__(329),record_response_1=__webpack_require__(9735),base_client_1=__webpack_require__(1497);class SymbolResponse extends record_response_1.BaseRecordResponse{constructor(response){super(response),this.symbol=response?.data?.data}}exports.SymbolResponse=SymbolResponse;class SymbolsResponse extends list_response_1.BaseListResponse{constructor(response){super(response),this.symbols=response?.data?.data?.map((record=>record.data))}}exports.SymbolsResponse=SymbolsResponse;class SymbolClient extends base_client_1.BaseClient{init(record){const builder=new create_record_builder_1.CreateRecordBuilder((async(record,authParams)=>this.createRecord("/symbols",SymbolResponse,record,authParams)));return builder.init(record)}from(record){const builder=new update_record_builder_1.UpdateRecordBuilder((async(record,authParams)=>this.updateRecord(`/symbols/${encodeURIComponent(record.data.handle)}`,SymbolResponse,record,authParams)));return builder.init(record)}async read(handle,authParams){return this.getRecord(`/symbols/${encodeURIComponent(handle)}`,SymbolResponse,authParams)}async list(params){return this.getRecordsList("/symbols",SymbolsResponse,params)}}exports.SymbolClient=SymbolClient},7361:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.WalletClient=exports.BalancesResponse=exports.WalletsResponse=exports.WalletResponse=void 0;const create_record_builder_1=__webpack_require__(1039),update_record_builder_1=__webpack_require__(477),list_response_1=__webpack_require__(329),record_response_1=__webpack_require__(9735),base_client_1=__webpack_require__(1497);class WalletResponse extends record_response_1.BaseRecordResponse{constructor(response){super(response),this.wallet=response?.data?.data}}exports.WalletResponse=WalletResponse;class WalletsResponse extends list_response_1.BaseListResponse{constructor(response){super(response),this.wallets=response?.data?.data?.map((record=>record.data))}}exports.WalletsResponse=WalletsResponse;class BalancesResponse extends list_response_1.BaseListResponse{constructor(response){super(response),this.balances=response?.data?.data?.map((record=>record.data))}}exports.BalancesResponse=BalancesResponse;class WalletClient extends base_client_1.BaseClient{init(record){const builder=new create_record_builder_1.CreateRecordBuilder((async(record,authParams)=>this.createRecord("/wallets",WalletResponse,record,authParams)));return builder.init(record)}from(record){const builder=new update_record_builder_1.UpdateRecordBuilder((async(record,authParams)=>this.updateRecord(`/wallets/${encodeURIComponent(record.data.handle)}`,WalletResponse,record,authParams)));return builder.init(record)}async read(handle,authParams){return this.getRecord(`/wallets/${encodeURIComponent(handle)}`,WalletResponse,authParams)}async list(params){return this.getRecordsList("/wallets",WalletsResponse,params)}async getBalances(handle,params){return this.getRecordsList(`/wallets/${encodeURIComponent(handle)}/balances`,BalancesResponse,params)}}exports.WalletClient=WalletClient},7175:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.LedgerSdk=void 0;const axios_1=__importDefault(__webpack_require__(2167)),nanoid_1=__webpack_require__(754),effect_client_1=__webpack_require__(7341),instance_client_1=__webpack_require__(6383),intent_client_1=__webpack_require__(7336),signer_client_1=__webpack_require__(9390),status_client_1=__webpack_require__(9659),symbol_client_1=__webpack_require__(7285),wallet_client_1=__webpack_require__(7361),bridge_client_1=__webpack_require__(1727),verify_response_signature_1=__webpack_require__(6194),ledger_sdk_error_1=__webpack_require__(5583);exports.LedgerSdk=class LedgerSdk{constructor(options){if(options.server.endsWith("/"))throw new Error(`Base URL shouldn't have a trailing slash: ${options.server}`);const apiClient=axios_1.default.create({baseURL:options.server,timeout:options.expiry||15e3});this.statusClient=new status_client_1.StatusClient(apiClient),this.instance=new instance_client_1.InstanceClient(apiClient,options.secure),this.symbol=new symbol_client_1.SymbolClient(apiClient,options.secure),this.wallet=new wallet_client_1.WalletClient(apiClient,options.secure),this.intent=new intent_client_1.IntentClient(apiClient,options.secure),this.signer=new signer_client_1.SignerClient(apiClient,options.secure),this.effect=new effect_client_1.EffectClient(apiClient,options.secure),this.bridge=new bridge_client_1.BridgeClient(apiClient,options.secure),this.handle={unique:(size=17)=>(0,nanoid_1.nanoid)(size)},this.options=options}async setAuthParams(authParams){this.instance.setAuthParams(authParams),this.symbol.setAuthParams(authParams),this.wallet.setAuthParams(authParams),this.intent.setAuthParams(authParams),this.signer.setAuthParams(authParams),this.effect.setAuthParams(authParams),this.bridge.setAuthParams(authParams)}async status(){return this.statusClient.read()}setSigner(signer){return this.options.signer=signer,this}async verify(record){try{return await(0,verify_response_signature_1.verifyResponseSignature)(record,this.options.signer)}catch(error){throw new ledger_sdk_error_1.LedgerSdkError(error)}}}},2266:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseRecordBuilder=void 0;const crypto_1=__webpack_require__(8286),ledger_sdk_error_1=__webpack_require__(5583),test_result_1=__webpack_require__(3859);exports.BaseRecordBuilder=class BaseRecordBuilder{enqueueAsyncOperation(operation){this.pendingAsyncOperations?this.pendingAsyncOperations=this.pendingAsyncOperations.then((()=>operation())):this.pendingAsyncOperations=operation()}async finishAsyncOperations(){this.pendingAsyncOperations&&await this.pendingAsyncOperations}init(record){return this.enqueueAsyncOperation((async()=>{this.record={hash:record?.hash||"",data:record?.data||{},meta:record?.meta||{signatures:[]}},this.record.meta.signatures||(this.record.meta.signatures=[])})),this}data(data){return this.enqueueAsyncOperation((async()=>{Object.assign(this.record.data,data)})),this}meta(meta){return this.enqueueAsyncOperation((async()=>{Object.assign(this.record.meta,meta)})),this}hash(hash){return this.enqueueAsyncOperation((async()=>{this.record.hash=hash||(0,crypto_1.createHash)(this.record.data)})),this}auth(params){return this.enqueueAsyncOperation((async()=>{Object.assign(this.authParams,params)})),this}sign(params){return this.enqueueAsyncOperation((async()=>{const hash=this.record.hash;if(!hash)throw new Error("Invalid record hash, set a hash by calling '.hash()' before attempting to sign a record.");for(const p of params){const signature=await(0,crypto_1.signHash)(hash,p.keyPair,p.custom);p.custom&&(signature.custom=p.custom),this.record.meta.signatures.push(signature)}})),this}async read(){try{return await this.finishAsyncOperations(),this.record}catch(error){throw new ledger_sdk_error_1.LedgerSdkError(error)}}async test(){try{await this.finishAsyncOperations();const results=[],hash=(0,crypto_1.createHash)(this.record.data);this.record?.hash!==hash?results.push(new test_result_1.LedgerRecordTestResult("invalid-hash",`Expected a hash value of '${hash}', but found '${this.record?.hash}'`)):results.push(new test_result_1.LedgerRecordTestResult("verified-hash",`Hash value '${hash} is valid'`));const signatures=this.record?.meta?.signatures;signatures||results.push(new test_result_1.LedgerRecordTestResult("no-signatures","No signatures found in 'meta.signatures'"));for(const signature of signatures){await(0,crypto_1.verifySignature)(hash,signature)?results.push(new test_result_1.LedgerRecordTestResult("verified-signature",`Signature with public key ${signature.public} is valid`)):results.push(new test_result_1.LedgerRecordTestResult("invalid-signature",`Signature with public key '${signature.public}' is invalid`))}return results}catch(error){throw new ledger_sdk_error_1.LedgerSdkError(error)}}}},1039:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.CreateRecordBuilder=void 0;const ledger_sdk_error_1=__webpack_require__(5583),base_record_builder_1=__webpack_require__(2266);class CreateRecordBuilder extends base_record_builder_1.BaseRecordBuilder{constructor(createRecord){super(),this.createRecord=createRecord}async send(){try{return await this.finishAsyncOperations(),this.createRecord(this.record,this.authParams)}catch(error){throw new ledger_sdk_error_1.LedgerSdkError(error)}}}exports.CreateRecordBuilder=CreateRecordBuilder},4918:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.SignIntentBuilder=void 0;const ledger_sdk_error_1=__webpack_require__(5583),base_record_builder_1=__webpack_require__(2266);exports.SignIntentBuilder=class SignIntentBuilder{constructor(sendSignature,intent){this.recordBuilder=new base_record_builder_1.BaseRecordBuilder,this.recordBuilder.init(intent),this.sendSignature=sendSignature,this.newSignaturesStartIndex=intent.meta?.signatures?.length||0}auth(params){return Object.assign(this.authParams,params),this}async read(){return this.recordBuilder.read()}hash(hash){return this.recordBuilder.hash(hash),this}sign(params){return this.recordBuilder.sign(params),this}async send(){try{const signatures=(await this.recordBuilder.read())?.meta?.signatures?.slice(this.newSignaturesStartIndex)||[];if(0===signatures.length)throw new Error("Unable to send signatures, no signatures found!");let result=null;for(let i=0;i<signatures.length;i++)result=await this.sendSignature(signatures[i],this.authParams);return result}catch(error){throw new ledger_sdk_error_1.LedgerSdkError(error)}}async test(){return this.recordBuilder.test()}}},6870:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.SignerRecordBuilder=void 0;const crypto_1=__webpack_require__(8286),types_1=__webpack_require__(8071),create_record_builder_1=__webpack_require__(1039);class SignerRecordBuilder extends create_record_builder_1.CreateRecordBuilder{async decryptSecret(secret){if(!this.password)throw new Error("Unable to decrypt secret without password, use '.code(password)' before calling '.keys()'");return(0,crypto_1.decryptSecretKey)(secret,this.password)}async extractKeyPair(){if(!this.record.data.schema||!this.record.data.public||!this.record.data.secret)throw new Error("Incomplete key pair in signer record, use '.data({ schema, public, secret })' or '.init()' before calling '.lock()' or '.keys()'");const secret=(0,crypto_1.isSecretKeyEncrypted)(this.record.data.secret)?await this.decryptSecret(this.record.data.secret):this.record.data.secret;return{schema:this.record.data.schema,public:this.record.data.public,secret}}code(password){return this.enqueueAsyncOperation((async()=>{this.password=password,this.record.data.secret&&!(0,crypto_1.isSecretKeyEncrypted)(this.record.data.secret)&&(this.record.data.secret=await(0,crypto_1.encryptSecretKey)(this.record.data.secret,password))})),this}lock(){return this.enqueueAsyncOperation((async()=>{const hash=this.record.hash;if(!hash)throw new Error("Invalid record hash, set a hash by calling '.hash()' before attempting to lock a record.");const keyPair=await this.extractKeyPair();this.record.meta.signatures.push(await(0,crypto_1.signHash)(hash,keyPair))})),this}async read(readOptions){const record=Object.assign({},await super.read()),{data}=record;if(readOptions?.plain&&data.secret&&(0,crypto_1.isSecretKeyEncrypted)(data.secret)){if(!this.password)throw new Error("Unable to decrypt secret without password, use '.code(password)' before calling '.keys()'");data.secret=await(0,crypto_1.decryptSecretKey)(data.secret,this.password)}return record}keys(keyPair){return this.enqueueAsyncOperation((async()=>{if(!keyPair.schema||!crypto_1.SUPPORTED_KEY_SCHEMAS.includes(keyPair.schema))throw new Error("Key schema not supported.");keyPair.public&&keyPair.secret||(keyPair=await(0,crypto_1.createKeyPair)()),this.record.data.public=keyPair.public,this.record.data.schema=keyPair.schema,this.record.data.secret=keyPair.secret,this.record.data.access=this.record.data.access||[{action:types_1.AccessAction.Any,signer:keyPair.public}]})),this}}exports.SignerRecordBuilder=SignerRecordBuilder},477:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.UpdateRecordBuilder=void 0;const lodash_1=__webpack_require__(6517),ledger_sdk_error_1=__webpack_require__(5583),base_record_builder_1=__webpack_require__(2266);class UpdateRecordBuilder extends base_record_builder_1.BaseRecordBuilder{constructor(updateRecord){super(),this.updateRecord=updateRecord}init(record){const recordClone=(0,lodash_1.cloneDeep)(record);return(0,lodash_1.set)(recordClone,"meta.signatures",[]),super.init(recordClone),this}data(data,replace=!1){return this.enqueueAsyncOperation((async()=>{if(replace)(0,lodash_1.set)(this.record,"data",data);else{let clonedData=(0,lodash_1.cloneDeep)(this.record.data);clonedData=(0,lodash_1.merge)(clonedData,data),clonedData=this.deepRemoveNull(clonedData),(0,lodash_1.set)(this.record,"data",clonedData)}})),this}deepRemoveNull(object){if(!(0,lodash_1.isObject)(object))return object;const wasArray=(0,lodash_1.isArray)(object),clear=Object.entries(object).filter((([,value])=>!1===(0,lodash_1.isNil)(value))).reduce(((r,[key,value])=>({...r,[key]:this.deepRemoveNull(value)})),{});return wasArray?Object.values(clear):clear}async send(){try{return await this.finishAsyncOperations(),this.updateRecord(this.record,this.authParams)}catch(error){throw new ledger_sdk_error_1.LedgerSdkError(error)}}}exports.UpdateRecordBuilder=UpdateRecordBuilder},6194:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.verifyResponseSignature=void 0;const crypto_1=__webpack_require__(8286),lodash_1=__importDefault(__webpack_require__(6517));exports.verifyResponseSignature=async(record,signer)=>{if(!signer.public)throw new Error("Missing public key.");if(!record.meta?.signatures?.length)throw new Error("This record has no signatures.");if(signatures=record.meta.signatures,publicKey=signer.public,!lodash_1.default.some(signatures,{public:publicKey}))throw new Error("Expected signature not found.");var signatures,publicKey;for(const signature of record.meta.signatures){if(!await(0,crypto_1.verifySignature)(record.hash,signature))throw new Error("This record has one or more invalid signatures.")}return!0}},5583:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.LedgerSdkError=void 0;const axios_1=__webpack_require__(2167),lodash_1=__importDefault(__webpack_require__(6517));class LedgerSdkError extends Error{constructor(causedBy){if(causedBy instanceof LedgerSdkError)return causedBy;if(super(),this.name="LedgerApiError",this.detail={},causedBy instanceof axios_1.AxiosError){const responseBody=causedBy.response?.data;responseBody?.data?.status?(this.status=responseBody.data.status,this.reason=responseBody.data.reason||"No reason provided",this.detail=responseBody.data.detail||{}):(this.status="unexpected-server-error",this.reason=causedBy.message||"Unexpected server error occurred!",this.detail={body:responseBody})}else this.status="unexpected-client-error",this.reason=causedBy.message;this.detail.causedBy=causedBy,this.message=this.reason}toJSON(){return lodash_1.default.merge({},this,{detail:{causedBy:null}})}}exports.LedgerSdkError=LedgerSdkError},329:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseListResponse=void 0;exports.BaseListResponse=class BaseListResponse{constructor(response){this.response=response,this.hash=response?.data?.hash,this.meta=response?.data?.meta,this.page=response?.data?.page}}},9735:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseRecordResponse=void 0;exports.BaseRecordResponse=class BaseRecordResponse{constructor(response){this.response=response,this.hash=response?.data?.hash,this.meta=response?.data?.meta}}},3859:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.LedgerRecordTestResult=void 0;exports.LedgerRecordTestResult=class LedgerRecordTestResult{constructor(status,detail,moment,client){this.status=status,this.detail=detail,this.moment=moment||(new Date).toISOString(),this.client=client||"ledger-sdk-js"}}},8071:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(__webpack_require__(4231),exports),__exportStar(__webpack_require__(230),exports),__exportStar(__webpack_require__(2565),exports),__exportStar(__webpack_require__(8035),exports),__exportStar(__webpack_require__(5585),exports),__exportStar(__webpack_require__(1147),exports),__exportStar(__webpack_require__(7479),exports),__exportStar(__webpack_require__(5797),exports),__exportStar(__webpack_require__(3297),exports),__exportStar(__webpack_require__(2080),exports),__exportStar(__webpack_require__(8777),exports),__exportStar(__webpack_require__(230),exports),__exportStar(__webpack_require__(1721),exports),__exportStar(__webpack_require__(4301),exports),__exportStar(__webpack_require__(4558),exports),__exportStar(__webpack_require__(7631),exports),__exportStar(__webpack_require__(7452),exports),__exportStar(__webpack_require__(7117),exports),__exportStar(__webpack_require__(8031),exports),__exportStar(__webpack_require__(7760),exports),__exportStar(__webpack_require__(5735),exports),__exportStar(__webpack_require__(5522),exports)},4231:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},230:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},2565:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},8035:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},5585:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.AccessAction=exports.AccessRecord=exports.SignerKeyword=void 0,function(SignerKeyword){SignerKeyword.LedgerSigner="$signer",SignerKeyword.AnySigner="*"}(exports.SignerKeyword||(exports.SignerKeyword={})),function(AccessRecord){AccessRecord.Any="any",AccessRecord.Server="server",AccessRecord.Ledger="ledger",AccessRecord.Signer="signer",AccessRecord.Symbol="symbol",AccessRecord.Wallet="wallet",AccessRecord.Intent="intent",AccessRecord.Effect="effect",AccessRecord.Bridge="bridge"}(exports.AccessRecord||(exports.AccessRecord={})),function(AccessAction){AccessAction.Any="any",AccessAction.Access="access",AccessAction.Create="create",AccessAction.Read="read",AccessAction.Update="update"}(exports.AccessAction||(exports.AccessAction={}))},1147:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},7479:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},8777:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},5797:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},3297:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},2080:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},1721:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},4301:(__unused_webpack_module,exports)=>{var BridgeSchema;Object.defineProperty(exports,"__esModule",{value:!0}),exports.BridgeSchemas=exports.BridgeSchema=void 0,function(BridgeSchema){BridgeSchema.Rest="rest"}(BridgeSchema=exports.BridgeSchema||(exports.BridgeSchema={})),exports.BridgeSchemas=Object.values(BridgeSchema)},4558:(__unused_webpack_module,exports)=>{var EffectActionSchema;Object.defineProperty(exports,"__esModule",{value:!0}),exports.EffectActionSchemas=exports.EffectActionSchema=void 0,function(EffectActionSchema){EffectActionSchema.webhook="webhook"}(EffectActionSchema=exports.EffectActionSchema||(exports.EffectActionSchema={})),exports.EffectActionSchemas=Object.values(EffectActionSchema)},7631:(__unused_webpack_module,exports)=>{var EventSignal;Object.defineProperty(exports,"__esModule",{value:!0}),exports.EventSignals=exports.EventSignal=void 0,function(EventSignal){EventSignal.BalanceReceived="balance-received",EventSignal.EffectCreated="effect-created",EventSignal.LedgerCreated="ledger-created",EventSignal.IntentCreated="intent-created",EventSignal.SignerCreated="signer-created",EventSignal.SymbolCreated="symbol-created",EventSignal.WalletCreated="wallet-created",EventSignal.BridgeCreated="bridge-created",EventSignal.EffectUpdated="effect-updated",EventSignal.LedgerUpdated="ledger-updated",EventSignal.IntentUpdated="intent-updated",EventSignal.SignerUpdated="signer-updated",EventSignal.SymbolUpdated="symbol-updated",EventSignal.WalletUpdated="wallet-updated",EventSignal.BridgeUpdated="bridge-updated"}(EventSignal=exports.EventSignal||(exports.EventSignal={})),exports.EventSignals=Object.values(EventSignal)},7452:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},7117:(__unused_webpack_module,exports)=>{var ClaimAction;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClaimActions=exports.ClaimAction=exports.IntentStatus=void 0,function(IntentStatus){IntentStatus.Pending="pending",IntentStatus.Committed="committed",IntentStatus.Completed="completed",IntentStatus.Aborted="aborted",IntentStatus.Rejected="rejected"}(exports.IntentStatus||(exports.IntentStatus={})),function(ClaimAction){ClaimAction.Issue="issue",ClaimAction.Transfer="transfer",ClaimAction.Destroy="destroy"}(ClaimAction=exports.ClaimAction||(exports.ClaimAction={})),exports.ClaimActions=Object.values(ClaimAction)},8031:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},7760:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},5735:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},5522:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.WalletRouteAction=void 0,function(WalletRouteAction){WalletRouteAction.Forward="forward",WalletRouteAction.Accept="accept"}(exports.WalletRouteAction||(exports.WalletRouteAction={}))},599:module=>{module.exports=require("@noble/ed25519")},2167:module=>{module.exports=require("axios")},7805:module=>{module.exports=require("detect-node")},1567:module=>{module.exports=require("jose")},6517:module=>{module.exports=require("lodash")},754:module=>{module.exports=require("nanoid")},8730:module=>{module.exports=require("safe-stable-stringify")},6113:module=>{module.exports=require("crypto")},3837:module=>{module.exports=require("util")}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.exports}var __webpack_exports__={};(()=>{var exports=__webpack_exports__;Object.defineProperty(exports,"__esModule",{value:!0}),exports.LedgerRecordTestResult=exports.LedgerSdkError=exports.LedgerSdk=exports.WalletsResponse=exports.WalletResponse=exports.SymbolsResponse=exports.SymbolResponse=exports.StatusResponse=exports.SignersResponse=exports.SignerResponse=exports.IntentsResponse=exports.IntentResponse=exports.BridgesResponse=exports.BridgeResponse=void 0;var bridge_client_1=__webpack_require__(1727);Object.defineProperty(exports,"BridgeResponse",{enumerable:!0,get:function(){return bridge_client_1.BridgeResponse}}),Object.defineProperty(exports,"BridgesResponse",{enumerable:!0,get:function(){return bridge_client_1.BridgesResponse}});var intent_client_1=__webpack_require__(7336);Object.defineProperty(exports,"IntentResponse",{enumerable:!0,get:function(){return intent_client_1.IntentResponse}}),Object.defineProperty(exports,"IntentsResponse",{enumerable:!0,get:function(){return intent_client_1.IntentsResponse}});var signer_client_1=__webpack_require__(9390);Object.defineProperty(exports,"SignerResponse",{enumerable:!0,get:function(){return signer_client_1.SignerResponse}}),Object.defineProperty(exports,"SignersResponse",{enumerable:!0,get:function(){return signer_client_1.SignersResponse}});var status_client_1=__webpack_require__(9659);Object.defineProperty(exports,"StatusResponse",{enumerable:!0,get:function(){return status_client_1.StatusResponse}});var symbol_client_1=__webpack_require__(7285);Object.defineProperty(exports,"SymbolResponse",{enumerable:!0,get:function(){return symbol_client_1.SymbolResponse}}),Object.defineProperty(exports,"SymbolsResponse",{enumerable:!0,get:function(){return symbol_client_1.SymbolsResponse}});var wallet_client_1=__webpack_require__(7361);Object.defineProperty(exports,"WalletResponse",{enumerable:!0,get:function(){return wallet_client_1.WalletResponse}}),Object.defineProperty(exports,"WalletsResponse",{enumerable:!0,get:function(){return wallet_client_1.WalletsResponse}});var sdk_1=__webpack_require__(7175);Object.defineProperty(exports,"LedgerSdk",{enumerable:!0,get:function(){return sdk_1.LedgerSdk}});var ledger_sdk_error_1=__webpack_require__(5583);Object.defineProperty(exports,"LedgerSdkError",{enumerable:!0,get:function(){return ledger_sdk_error_1.LedgerSdkError}});var test_result_1=__webpack_require__(3859);Object.defineProperty(exports,"LedgerRecordTestResult",{enumerable:!0,get:function(){return test_result_1.LedgerRecordTestResult}})})();var __webpack_export_target__=exports;for(var i in __webpack_exports__)__webpack_export_target__[i]=__webpack_exports__[i];__webpack_exports__.__esModule&&Object.defineProperty(__webpack_export_target__,"__esModule",{value:!0})})();